{"ts":1340264192997,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var sip = require('sip');\nvar digest = require('sip/digest');\n\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\n\nvar authReg = {\n    method: 'REGISTER',\n    uri: uri,\n    headers: {\n      to: {\n        uri: uri\n      },\n      from: {\n        uri: uri,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'REGISTER',\n        seq: 1\n      },\n      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    }\n  };\n  \n  \n  \n  \n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n  \n  \n});\n\n\nsip.send(authReg, function(rs) {\n  console.log('CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC');\n  console.log(rs.headers);\n  \n\n  console.log('--------------------' + JSON.stringify(authReg.headers));\n\n  digest.signRequest({\n    realm: 'sipgate.de'\n  }, authReg, rs, cred);\n\n\n  console.log('+++++++++++++++++' + JSON.stringify(authReg.headers));\n\n\n  sip.send(authReg, function(rs1) {\n    console.log('AAAAAAAAAAAAAAAAAAAAAAAAA');\n    console.log(rs1);\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n  })\n\n});"]],"start1":0,"start2":0,"length1":0,"length2":2068}]],"length":2068}
{"contributors":[],"silentsave":false,"ts":1340310130602,"patch":[[{"diffs":[[0,";\n  \n  \n"],[-1,"  \n  "],[1,"\n"],[0,"\n\nsip.st"]],"start1":767,"start2":767,"length1":21,"length2":17},{"diffs":[[0,"}\n  "],[-1,"\n"],[0,"  \n});\n\n"],[-1,"\n"],[1,"register();\n\n\nfunction register() {\n  "],[0,"sip."]],"start1":1431,"start2":1431,"length1":18,"length2":54},{"diffs":[[0,"ction(rs) {\n"],[1,"  "],[0,"  console.lo"]],"start1":1502,"start2":1502,"length1":24,"length2":26},{"diffs":[[0,"g('CCCCCCCCCCCCC"],[-1,"CCCCCC"],[1," response on register "],[0,"CCCCCCCCCCCCCCCC"]],"start1":1528,"start2":1528,"length1":38,"length2":54},{"diffs":[[0,"CCCCCCCC');\n"],[1,"  "],[0,"  console.lo"]],"start1":1574,"start2":1574,"length1":24,"length2":26},{"diffs":[[0,"g(rs"],[-1,".headers);\n  \n\n  console.log('--------------------' + JSON.stringify(authReg.headers));\n\n"],[1,");    \n\n    if(rs.status === 401)  //reason Unauthorized\n    {  \n    "],[0,"  di"]],"start1":1600,"start2":1600,"length1":97,"length2":77},{"diffs":[[0,"quest({\n"],[1,"    "],[0,"    real"]],"start1":1688,"start2":1688,"length1":16,"length2":20},{"diffs":[[0,"ate.de'\n"],[1,"    "],[0,"  }, aut"]],"start1":1716,"start2":1716,"length1":16,"length2":20},{"diffs":[[0,"d);\n"],[-1,"\n\n  console.log('+++++++++++++++++' + JSON.stringify(authReg.headers));\n\n\n  sip.send(authReg, function(rs1) {\n    console.log('AAAAAAAAAAAAAAAAAAAAAAAAA');\n    console.log(rs1);\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n    console.log('');\n  })\n\n});"],[1,"      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":1749,"start2":1749,"length1":359,"length2":193}]],"length":1942,"saved":false}
{"contributors":[],"silentsave":false,"ts":1340316306329,"patch":[[{"diffs":[[1,"var sip = require('sip');\nvar digest = require('sip/digest');\n\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\n\nvar authReg = {\n    method: 'REGISTER',\n    uri: uri,\n    headers: {\n      to: {\n        uri: uri\n      },\n      from: {\n        uri: uri,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'REGISTER',\n        seq: 1\n      },\n      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    }\n  };\n  \n  \n\n\n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {\n  sip.send(authReg, function(rs) {\n    console.log('CCCCCCCCCCCCC response on register CCCCCCCCCCCCCCCC');\n    console.log(rs);    \n\n    if(rs.status === 401)  //reason Unauthorized\n    {  \n      digest.signRequest({\n        realm: 'sipgate.de'\n      }, authReg, rs, cred);\n      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":1942}]],"length":1942,"saved":false}
{"contributors":[],"silentsave":false,"ts":1340568438619,"patch":[[{"diffs":[[0,"}\n\n\n"],[-1,"var sip = require('sip');\nvar digest = require('sip/digest');\n\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\n\nvar authReg = {\n    method: 'REGISTER',\n    uri: uri,\n    headers: {\n      to: {\n        uri: uri\n      },\n      from: {\n        uri: uri,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'REGISTER',\n        seq: 1\n      },\n      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    }\n  };\n  \n  \n\n\n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {\n  sip.send(authReg, function(rs) {\n    console.log('CCCCCCCCCCCCC response on register CCCCCCCCCCCCCCCC');\n    console.log(rs);    \n\n    if(rs.status === 401)  //reason Unauthorized\n    {  \n      digest.signRequest({\n        realm: 'sipgate.de'\n      }, authReg, rs, cred);\n      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":1938,"start2":1938,"length1":1946,"length2":4}]],"length":1942,"saved":false}
{"contributors":[],"silentsave":true,"ts":1343249971514,"patch":[[{"diffs":[[0,"('sip');"],[1,"\r"],[0,"\nvar dig"]],"start1":17,"start2":17,"length1":16,"length2":17},{"diffs":[[0,"igest');"],[-1,"\n\n"],[1,"\r\nvar sf = require('node-salesforce');\r\nvar Pusher = require('node-pusher');\r\n\r\nvar mysipport = process.env.PORT;\r\nvar myhost = 'ec2-23-22-135-42.compute-1.amazonaws.com';\r\n\r\n\r\nvar pusher = new Pusher({\r\n  appId: '10536',\r\n  key: '0bcfb89cee9d117b2b4e',\r\n  secret: '14404ce2f3383cb9222b'\r\n});\r\n\r\n\r\n\r\nconsole.log('XXXXXXXXXXX    ADDRESS XXXXXXXXXXXXX');\r\nconsole.log('sip:' + myhost + ':' + mysipport);\r\n\r\n\r\nvar uri = 'sip:0435009722.320@sip12.e-fon.ch';\r\nvar cred = {\r\n  user: '0435009722.320',\r\n  password: 'parxwerk123',\r\n  realm: 'asterisk'\r\n};\r\n\r\n/*\r"],[0,"\nvar uri"]],"start1":54,"start2":54,"length1":18,"length2":570},{"diffs":[[0,"ate.de';"],[-1,"\n"],[1,"\r"],[0,"\nvar cre"]],"start1":644,"start2":644,"length1":17,"length2":17},{"diffs":[[0,"cred = {"],[1,"\r"],[0,"\n  user:"]],"start1":658,"start2":658,"length1":16,"length2":17},{"diffs":[[0,"835084',"],[1,"\r"],[0,"\n  passw"]],"start1":678,"start2":678,"length1":16,"length2":17},{"diffs":[[0,"AUPSSZ',"],[1,"\r"],[0,"\n  realm"]],"start1":701,"start2":701,"length1":16,"length2":17},{"diffs":[[0,".de'"],[1,"\r"],[0,"\n};"],[-1,"\n\n"],[1,"\r\n*/\r\n\r\n\r\n\r\n\r"],[0,"\n//h"]],"start1":728,"start2":728,"length1":13,"length2":25},{"diffs":[[0,"+PHP-SIP"],[-1,"\n"],[1,"\r\n\r"],[0,"\nvar aut"]],"start1":805,"start2":805,"length1":17,"length2":19},{"diffs":[[0,"thReg = "],[-1,"{\n "],[1,"initRegisterMsg();\r\n\r\nfunction initRegisterMsg() {\r\nreturn {\r\n"],[0,"   "],[1," "],[0,"method: "]],"start1":823,"start2":823,"length1":22,"length2":82},{"diffs":[[0," 'REGISTER',"],[1,"\r"],[0,"\n    uri: ur"]],"start1":904,"start2":904,"length1":24,"length2":25},{"diffs":[[0,"   uri: uri,"],[1,"\r"],[0,"\n    headers"]],"start1":919,"start2":919,"length1":24,"length2":25},{"diffs":[[0,"  headers: {"],[1,"\r"],[0,"\n      to: {"]],"start1":935,"start2":935,"length1":24,"length2":25},{"diffs":[[0,"   to: {"],[1,"\r"],[0,"\n       "]],"start1":952,"start2":952,"length1":16,"length2":17},{"diffs":[[0,"uri: uri"],[1,"\r"],[0,"\n      }"]],"start1":970,"start2":970,"length1":16,"length2":17},{"diffs":[[0,"ri\r\n      },"],[1,"\r"],[0,"\n      from:"]],"start1":976,"start2":976,"length1":24,"length2":25},{"diffs":[[0," from: {"],[1,"\r"],[0,"\n       "]],"start1":995,"start2":995,"length1":16,"length2":17},{"diffs":[[0,"ri: uri,"],[1,"\r"],[0,"\n       "]],"start1":1014,"start2":1014,"length1":16,"length2":17},{"diffs":[[0,"arams: {"],[1,"\r"],[0,"\n       "]],"start1":1033,"start2":1033,"length1":16,"length2":17},{"diffs":[[0,"2345678'"],[1,"\r"],[0,"\n       "]],"start1":1060,"start2":1060,"length1":16,"length2":17},{"diffs":[[0,"       }"],[1,"\r"],[0,"\n      }"]],"start1":1071,"start2":1071,"length1":16,"length2":17},{"diffs":[[0," }\r\n      },"],[1,"\r"],[0,"\n      'call"]],"start1":1077,"start2":1077,"length1":24,"length2":25},{"diffs":[[0," * 1e6),"],[1,"\r"],[0,"\n      c"]],"start1":1132,"start2":1132,"length1":16,"length2":17},{"diffs":[[0," cseq: {"],[1,"\r"],[0,"\n       "]],"start1":1147,"start2":1147,"length1":16,"length2":17},{"diffs":[[0,"GISTER',"],[1,"\r"],[0,"\n       "]],"start1":1176,"start2":1176,"length1":16,"length2":17},{"diffs":[[0,"  seq: 1"],[1,"\r"],[0,"\n      }"]],"start1":1192,"start2":1192,"length1":16,"length2":17},{"diffs":[[0,"      },"],[1,"\r"],[0,"\n      e"]],"start1":1202,"start2":1202,"length1":16,"length2":17},{"diffs":[[0,"dialog',"],[1,"\r"],[0,"\n      a"]],"start1":1226,"start2":1226,"length1":16,"length2":17},{"diffs":[[0,"fo+xml',"],[1,"\r"],[0,"\n      e"]],"start1":1272,"start2":1272,"length1":16,"length2":17},{"diffs":[[0,"s: 3600,"],[1,"\r"],[0,"\n      c"]],"start1":1294,"start2":1294,"length1":16,"length2":17},{"diffs":[[0,"tact: [{"],[1,"\r\n\r"],[0,"\n       "]],"start1":1313,"start2":1313,"length1":16,"length2":19},{"diffs":[[0,"sip:"],[-1,"gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT"],[1,"' + myhost + ':' + mysipport\r\n      }]\r\n    }\r\n  };\r\n \r\n}\r\n  \r\nvar subscribeMsg = {\r\n    method: 'SUBSCRIBE',\r\n    uri: uri + ';user=phone',\r\n    headers: {\r\n      to: {\r\n        uri: uri + ';user=phone'\r\n      },\r\n      from: {\r\n        uri: uri,\r\n        params: {\r\n          tag: '12345678'\r\n        }\r\n      },\r\n      'call-id': Math.floor(Math.random() * 1e6),\r\n      cseq: {\r\n        method: 'SUBSCRIBE',\r\n        seq: 2\r\n      },\r\n      event: 'dialog',\r\n      accept: 'application/dialog-info+xml',\r\n      expires: 3600,\r\n      contact: [{\r\n        uri: 'sip:' + myhost + ':' + mysipport\r"],[0,"\n   "]],"start1":1339,"start2":1339,"length1":66,"length2":604},{"diffs":[[0,"  }]"],[1,"\r"],[0,"\n    }"],[1,"\r"],[0,"\n  };"],[-1,"\n  \n  \n\n\n"],[1,"\r\n\r\n\r"],[0,"\nsip"]],"start1":1944,"start2":1944,"length1":28,"length2":26},{"diffs":[[0,".start({"],[1,"\r"],[0,"\n  port:"]],"start1":1970,"start2":1970,"length1":16,"length2":17},{"diffs":[[0,"rt: "],[-1,"process.env.C9_PORT,"],[1,"mysipport,\r"],[0,"\n  l"]],"start1":1984,"start2":1984,"length1":28,"length2":19},{"diffs":[[0,"ogger: {"],[1,"\r"],[0,"\n//    r"]],"start1":2003,"start2":2003,"length1":16,"length2":17},{"diffs":[[0,"ole.log,"],[1,"\r"],[0,"\n"],[-1,"//"],[0,"    send"]],"start1":2029,"start2":2029,"length1":19,"length2":18},{"diffs":[[0,"sole.log"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n}, func"]],"start1":2052,"start2":2052,"length1":20,"length2":22},{"diffs":[[0,"on(rq) {"],[1,"\r"],[0,"\n  conso"]],"start1":2076,"start2":2076,"length1":16,"length2":17},{"diffs":[[0,"XXXXXXXXXXXXX');"],[1,"\r"],[0,"\n  console.log('"]],"start1":2126,"start2":2126,"length1":32,"length2":33},{"diffs":[[0,"XXXXXXXXXXXXX');"],[1,"\r"],[0,"\n  console.log('"]],"start1":2184,"start2":2184,"length1":32,"length2":33},{"diffs":[[0,"XXXXXXXXXXXXX');"],[1,"\r"],[0,"\n  console.log('"]],"start1":2242,"start2":2242,"length1":32,"length2":33},{"diffs":[[0,"XXXXXXXXXXXXX');"],[1,"\r"],[0,"\n  console.log('"]],"start1":2300,"start2":2300,"length1":32,"length2":33},{"diffs":[[0,"XXXXXXXXXXXXX');"],[1,"\r"],[0,"\n  console.log('"]],"start1":2358,"start2":2358,"length1":32,"length2":33},{"diffs":[[0,"XXXXX');"],[1,"\r"],[0,"\n  conso"]],"start1":2424,"start2":2424,"length1":16,"length2":17},{"diffs":[[0,"log(rq);"],[1,"\r"],[0,"\n  conso"]],"start1":2444,"start2":2444,"length1":16,"length2":17},{"diffs":[[0,"eaders);"],[1,"\r"],[0,"\n  "],[-1,"\n"],[1,"\r\n  "],[0,"  if(rq."]],"start1":2472,"start2":2472,"length1":20,"length2":24},{"diffs":[[0,"') {"],[1,"\r"],[0,"\n//"],[-1,"    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {"],[1,"\t\tsip.send(sip.makeResponse(rq, 100, 'Trying'));\r\n\t    \tsip.send(sip.makeResponse(rq, 180, 'Ringing'));\r\n\r\n\r\n\r\n\t\tvar number = rq.headers.from.uri;\r\n\t\tvar callid = rq.headers['call-id'];\r\n\r\n\r\npusher.trigger('test_channel', 'my_event', {\"number\" : number.split(':')[1]  }, null, function(err, req, res) {\r\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX   pusher ');\r\n  console.log(err);\r\n\r\n  console.log(req);\r\n\r\n  console.log(res);\r\n\r\n});\r\n\r\n\r\n\t\tvar now = new Date();\r\n\t\tvar jsonDate = now.toJSON();\r\n\r\n\t\tsip.send(sip.makeResponse(rq, 180, 'Ringing'));\r\n\r\n\t\tconn.sobject(\"SipLog__c\").upsert({ \r\n\t\t\tCallId__c : callid,\r\n\t\t\tNumber__c : number,\r\n\t\t\tTimestampRing__c : jsonDate\t\t\r\n\t\t}, 'CallId__c', function(err, ret) {\r\n\t\t  if (!err && ret.success) {\r\n\t\t    console.log('Upserted Successfully');\r\n\t\t  }\r\n\t\t});\r\n\r\n\r\n\r\n\r\n\t} else if(rq.method === 'CANCEL') {\r\n\t\tvar number = rq.headers.from.uri;\r\n\t\tvar callid = rq.headers['call-id'];\r\n\r\n\t\tvar now = new Date();\r\n\t\tvar jsonDate = now.toJSON();\r\n\r\n\t\tsip.send(sip.makeResponse(rq, 180, 'Ringing'));\r\n\r\n\t\tconn.sobject(\"SipLog__c\").upsert({ \r\n\t\t\tCallId__c : callid,\r\n\t\t\tNumber__c : number,\r\n\t\t\tTimestampCancel__c : jsonDate\t\t\r\n\t\t}, 'CallId__c', function(err, ret) {\r\n\t\t  if (!err && ret.success) {\r\n\t\t    console.log('Upserted Successfully');\r\n\t\t  }\r\n\t\t});\r\n\t}\r\n    \r\n});\r\n\r\n\r\n\r\n\r\nregister();\r\n//subscribe();\r\n\r\nvar conn = new sf.Connection({\r\n\tloginUrl : 'https://login.salesforce.com'\r\n});\r\n\r\nfunction sfLogin() {\r\n\tconn.login('thomas.schnocklake.sfdc1@gmail.com', 'Mail2GoAwayLo4rMXTSWwqCeH7sClgWs1Y9', function(err) {\r\n\t\tif (!err) {\r\n\t\t\tconsole.log('------------------------Login SF token------------------------------------');\r\n\t\t\tconsole.log(conn.accessToken);\r\n\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tconsole.log('------------------------RE Login SF------------------------------------');\r\n\t\t\t\tsfLogin();\r\n\t\t\t}, 600000);\r\n\r\n\r\n\t\t} else {\r\n\t\t\tconsole.log(err);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nsfLogin();\r\n\r\n\r\nfunction register() {\r\ndelete authReg.headers.via;\r"],[0,"\n  s"]],"start1":2514,"start2":2514,"length1":163,"length2":2001},{"diffs":[[0,"on(rs) {"],[1,"\r"],[0,"\n    con"]],"start1":4538,"start2":4538,"length1":16,"length2":17},{"diffs":[[0,"CCCCC');"],[1,"\r"],[0,"\n    con"]],"start1":4611,"start2":4611,"length1":16,"length2":17},{"diffs":[[0,"log("],[-1,"rs"],[1,"JSON.stringify(rs,null,'\\t')"],[0,");    "],[-1,"\n"],[1,"\r\n\r"],[0,"\n   "]],"start1":4633,"start2":4633,"length1":17,"length2":45},{"diffs":[[0,"ized"],[1,"\r"],[0,"\n    {  "],[1,"\r\n    console.log('CyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyC' + cred.realm);\r\n    console.log('CyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyC' + JSON.stringify(rs.headers[\"www-authenticate\"]));\r\n    console.log('CyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyC' + JSON.stringify(rs.headers[\"www-authenticate\"][\"realm\"]));\r\n\r"],[0,"\n   "]],"start1":4719,"start2":4719,"length1":16,"length2":314},{"diffs":[[0,"equest({"],[1,"\r"],[0,"\n       "]],"start1":5048,"start2":5048,"length1":16,"length2":17},{"diffs":[[0," realm: "],[-1,"'sipgate.de'"],[1,"cred.realm\r"],[0,"\n      }"]],"start1":5065,"start2":5065,"length1":28,"length2":27},{"diffs":[[0,", cred);"],[-1,"\n      "],[1,"\r\n\r\n\r\n    console.log('CyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyC');\r\n    console.log(authReg);    \r\n      \r"],[0,"\n      r"]],"start1":5105,"start2":5105,"length1":23,"length2":118},{"diffs":[[0,"ister();"],[1,"\r"],[0,"\n    } e"]],"start1":5225,"start2":5225,"length1":16,"length2":17},{"diffs":[[0,"eason OK"],[1,"\r"],[0,"\n    {"],[1,"\r"],[0,"\n      c"]],"start1":5272,"start2":5272,"length1":22,"length2":24},{"diffs":[[0,"-');"],[-1,"\n    }\n  "],[1,"\r\n\r\n\r\n  \r\n  \tsetTimeout(function(){\r\n\t\t\tconsole.log('------------------------REREGISTERIND------------------------------------');\r\n\t\t\tauthReg = initRegisterMsg();\r\n\t\t\tregister();\r\n\t\t}, 300000);\r\n\r\n//\tsubscribe();\r\n\r\n\r\n\r\n    }\r\n  \r"],[0,"\n  });"],[1,"\r"],[0,"\n}"],[-1,"\n\n"],[1,"\r\n\r\n\r\n\r\nfunction subscribe() {\r\n  sip.send(subscribeMsg , function(rs) {\r\n    console.log('CCCCCCCCCCCCC response on subscribe CCCCCCCCCCCCCCCC');\r\n    console.log(JSON.stringify(rs,null,'\\t'));    \r\n\r\n    if(rs.status === 407)  //reason Unauthorized\r\n    {  \r\n\r\n      digest.signRequest({\r\n        realm: cred.realm\r\n      }, subscribeMsg, rs, cred);\r\n\r\n      \r\n      subscribe();\r\n    } else if(rs.status === 200)  //reason OK\r\n    {\r\n      console.log('------------------------SUBSCRIBED------------------------------------');\r\n\r\n    }\r\n  \r\n  });\r\n}\r\n\r"],[0,"\n"]],"start1":5377,"start2":5377,"length1":24,"length2":799}]],"length":6176,"saved":false}
{"ts":1343250081426,"patch":[[{"diffs":[[0," = '"],[-1,"ec2-23-22-135-42.compute-1.amazonaws.com"],[1,"gapps_script_shared.tsschnoc.c9.io"],[0,"';\r\n"]],"start1":187,"start2":187,"length1":48,"length2":42}]],"length":6170,"saved":false}
{"ts":1343250094241,"patch":[[{"diffs":[[0,"e.log,\r\n"],[1,"//"],[0,"    send"]],"start1":2025,"start2":2025,"length1":16,"length2":18}]],"length":6172,"saved":false}
