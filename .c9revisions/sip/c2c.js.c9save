{"ts":1340307297407,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var sip = require('sip');\nvar digest = require('sip/digest');\n\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\n\nvar authReg = {\n    method: 'REGISTER',\n    uri: uri,\n    headers: {\n      to: {\n        uri: uri\n      },\n      from: {\n        uri: uri,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'REGISTER',\n        seq: 1\n      },\n      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    }\n  };\n  \n  \n\n\n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {\n  sip.send(authReg, function(rs) {\n    console.log('CCCCCCCCCCCCC response on register CCCCCCCCCCCCCCCC');\n    console.log(rs);    \n\n    if(rs.status === 401)  //reason Unauthorized\n    {  \n      digest.signRequest({\n        realm: 'sipgate.de'\n      }, authReg, rs, cred);\n      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":1942}]],"length":1942}
{"contributors":[],"silentsave":false,"ts":1340310130642,"patch":[[{"diffs":[[0,"est');\n\n"],[-1,"\n"],[0,"var uri "]],"start1":55,"start2":55,"length1":17,"length2":16},{"diffs":[[0,"de'\n};\n\n"],[-1,"\n"],[0,"//http:/"]],"start1":172,"start2":172,"length1":17,"length2":16},{"diffs":[[0,"+PHP-SIP"],[1,"\nvar from = 'sip:1835084@sipgate.de';\nvar to = 'sip:004123423423424324@sipgate.de';"],[0,"\n\nvar au"]],"start1":235,"start2":235,"length1":16,"length2":99},{"diffs":[[0,"   method: '"],[-1,"REGIS"],[1,"INVI"],[0,"TE"],[-1,"R"],[0,"',\n    uri: "]],"start1":345,"start2":345,"length1":32,"length2":30},{"diffs":[[0,"',\n    uri: "],[-1,"uri"],[1,"from"],[0,",\n    header"]],"start1":363,"start2":363,"length1":27,"length2":28},{"diffs":[[0,"   uri: "],[-1,"uri"],[1,"'sip:c2c@gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT"],[0,",\n      "]],"start1":453,"start2":453,"length1":19,"length2":83},{"diffs":[[0,"ethod: '"],[-1,"REGIS"],[1,"INVI"],[0,"TE"],[-1,"R"],[0,"',\n     "]],"start1":666,"start2":666,"length1":24,"length2":22},{"diffs":[[0," },\n"],[-1,"      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n"],[0,"    "]],"start1":703,"start2":703,"length1":76,"length2":8}]],"length":2016,"saved":false}
{"contributors":[],"silentsave":false,"ts":1340316306178,"patch":[[{"diffs":[[1,"var from = 'sip:1835084@sipgate.de';\nvar from2 = 'sip:091130835084@sipgate.de';\nvar to = 'sip:004123423423424324@sipgate.de';\n\n\nvar sip = require('sip');\nvar digest = require('sip/digest');\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\n\nvar authReg = {\n    method: 'INVITE',\n    uri: from2,\n    headers: {\n      to: {\n        uri: from2\n      },\n      from: {\n        Name: 'der toller thomas',\n        uri: from,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'INVITE',\n        seq: 1\n      },\n      event: 'dialog',\n      accept: 'application/dialog-info+xml',\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    \n    },\n      content:\n    'v=0\\r\\n'+\n    'o=- 13374 13374 IN IP4 172.16.2.2\\r\\n'+\n    's=-\\r\\n'+\n    'c=IN IP4 172.16.2.2\\r\\n'+\n    't=0 0\\r\\n'+\n    'm=audio 16424 RTP/AVP 0 8 101\\r\\n'+\n    'a=rtpmap:0 PCMU/8000\\r\\n'+\n    'a=rtpmap:8 PCMA/8000\\r\\n'+\n    'a=rtpmap:101 telephone-event/8000\\r\\n'+\n    'a=fmtp:101 0-15\\r\\n'+\n    'a=ptime:30\\r\\n'+\n    'a=sendrecv\\r\\n'\n  };\n  \n  \n\n\n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {\n  \n  console.log(authReg);\n  \n  \n  sip.send(authReg, function(rs) {\n    console.log('CCCCCCCCCCCCC response on register CCCCCCCCCCCCCCCC');\n    console.log(rs);    \n    //console.log(rs.headers);    \n\n    if(rs.status === 407)  //reason Unauthorized\n    {  \n      digest.signRequest({\n        realm: 'sipgate.de'\n      }, authReg, rs, cred);\n      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":2537}]],"length":2537,"saved":false}
{"contributors":[],"silentsave":false,"ts":1340316350813,"patch":[[{"diffs":[[0,"me: "],[-1,"'der toller thomas'"],[1,"from2"],[0,",\n  "]],"start1":507,"start2":507,"length1":27,"length2":13},{"diffs":[[0,"ri: from"],[1,"2"],[0,",\n      "]],"start1":527,"start2":527,"length1":16,"length2":17}]],"length":2524,"saved":false}
{"ts":1340316371747,"patch":[[{"diffs":[[0,"  Name: from"],[-1,"2"],[0,",\n        ur"]],"start1":503,"start2":503,"length1":25,"length2":24},{"diffs":[[0,"   uri: from"],[-1,"2"],[0,",\n        pa"]],"start1":522,"start2":522,"length1":25,"length2":24}]],"length":2522,"saved":false}
{"ts":1340316398830,"patch":[[{"diffs":[[0,"  Name: from"],[1,"2"],[0,",\n        ur"]],"start1":503,"start2":503,"length1":24,"length2":25}]],"length":2523,"saved":false}
{"contributors":[],"silentsave":false,"ts":1340568438606,"patch":[[{"diffs":[[0,"}\n\n\n"],[-1,"var sip = require('sip');\nvar digest = require('sip/digest');\n\nvar uri = 'sip:1835084@sipgate.de';\n\nvar cred = {\n  user: '1835084',\n  password: 'AUPSSZ',\n  realm: 'sipgate.de'\n};\n\n//http://level7systems.co.uk/en/blog/Click+to+Call+with+PHP-SIP\nvar from = 'sip:1835084@sipgate.de';\nvar to = 'sip:004123423423424324@sipgate.de';\n\nvar authReg = {\n    method: 'INVITE',\n    uri: from,\n    headers: {\n      to: {\n        uri: uri\n      },\n      from: {\n        uri: 'sip:c2c@gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT,\n        params: {\n          tag: '12345678'\n        }\n      },\n      'call-id': Math.floor(Math.random() * 1e6),\n      cseq: {\n        method: 'INVITE',\n        seq: 1\n      },\n      expires: 3600,\n      contact: [{\n        uri: 'sip:gapps_script_shared.tsschnoc.c9.io:' + process.env.C9_PORT\n      }]\n    }\n  };\n  \n  \n\n\n\nsip.start({\n  port: process.env.C9_PORT,\n  logger: {\n//    recv: console.log,\n//    send: console.log\n  }\n}, function(rq) {\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');\n  console.log(rq);\n  console.log(rq.headers);\n  \n  if(rq.method === 'INVITE') {\n//    sip.send(sip.makeResponse(rq, 100, 'Trying'));\n    sip.send(sip.makeResponse(rq, 180, 'Ringing'));\n  }\n    \n});\n\nregister();\n\n\nfunction register() {\n  sip.send(authReg, function(rs) {\n    console.log('CCCCCCCCCCCCC response on register CCCCCCCCCCCCCCCC');\n    console.log(rs);    \n\n    if(rs.status === 401)  //reason Unauthorized\n    {  \n      digest.signRequest({\n        realm: 'sipgate.de'\n      }, authReg, rs, cred);\n      \n      register();\n    } else if(rs.status === 200)  //reason OK\n    {\n      console.log('------------------------REGISTERED------------------------------------');\n    }\n  \n  });\n}\n\n\n"]],"start1":2519,"start2":2519,"length1":2020,"length2":4}]],"length":2523,"saved":false}
