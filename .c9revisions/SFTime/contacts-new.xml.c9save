{"ts":1374143804468,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1374143684028,"patch":[[{"diffs":[[1,"<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<Module>\r\n  <ModulePrefs title=\"Google Contacts Gadget\">\r\n\r\n  <Require feature=\"opensocial-0.7\"/>\r\n\r\n  <OAuth>\r\n    <Service name=\"google\">\r\n      <Access \r\n         url=\"https://www.google.com/accounts/OAuthGetAccessToken\"\r\n         method=\"GET\" />\r\n\r\n      <Request\r\n         url=\"https://www.google.com/accounts/OAuthGetRequestToken?scope=http://www.google.com/m8/feeds/\"\r\n         method=\"GET\" />\r\n\r\n      <Authorization\r\n         url=\"https://www.google.com/accounts/OAuthAuthorizeToken\" />\r\n    </Service>\r\n  </OAuth>\r\n\r\n  </ModulePrefs>\r\n  <Content type=\"html\">\r\n      <![CDATA[\r\n\r\n    <style>\r\n    #main {\r\n        margin: 0px;\r\n        padding: 0px;\r\n        font-size: small;\r\n    }\r\n    </style>\r\n\r\n    <div id=\"main\" style=\"display: none\">\r\n    </div>\r\n\r\n    <div id=\"approval\" style=\"display: none\">\r\n      <img src=\"http://dirk.balfanz.googlepages.com/new.gif\">\r\n      <a id=\"personalize\"\r\n        onclick=\"javascript:showOneSection('waiting'); return true\"\r\n        target=\"approve\">Personalize this gadget</a>\r\n    </div>\r\n\r\n    <div id=\"waiting\" style=\"display: none\">\r\n      Please click\r\n      <a onclick=\"javascript:fetchData()\">I've approved access</a>\r\n      once you've approved access to your data.\r\n    </div>\r\n\r\n    <script type=\"text/javascript\">\r\n      function showOneSection(toshow) {\r\n        var sections = [ 'main', 'approval', 'waiting' ];\r\n        for (var i=0; i < sections.length; ++i) {\r\n          var s = sections[i];\r\n          var el = document.getElementById(s);\r\n          if (s === toshow) {\r\n            el.style.display = \"block\";\r\n          } else {\r\n            el.style.display = \"none\";\r\n          }\r\n        }\r\n      }\r\n\r\n      function showResults(result) {\r\n        showOneSection('main');\r\n\r\n        var titleElement = document.createElement('div');\r\n\r\n        var nameNode = document.createTextNode(result.feed.title.$t);\r\n\r\n        titleElement.appendChild(nameNode);\r\n\r\n        document.getElementById(\"main\").appendChild(titleElement);\r\n        document.getElementById(\"main\").appendChild(document.createElement(\"br\"));\r\n\r\n        list = result.feed.entry;\r\n\r\n        for(var i = 0; i < list.length; i++) {\r\n\r\n          entry = list[i];\r\n\r\n          var divElement = document.createElement('div');\r\n          divElement.setAttribute('class', 'name');\r\n\r\n          var valueNode = document.createTextNode(entry.gd$email[0].address);\r\n\r\n          divElement.appendChild(nameNode);\r\n          divElement.appendChild(valueNode);\r\n\r\n          document.getElementById(\"main\").appendChild(divElement);\r\n        }\r\n      }\r\n\r\n      function fetchData() {\r\n        var params = {};\r\n        url = \"http://www.google.com/m8/feeds/contacts/default/base?alt=json\";\r\n        params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;\r\n        params[gadgets.io.RequestParameters.AUTHORIZATION] = gadgets.io.AuthorizationType.AUTHENTICATED;\r\n        params[gadgets.io.RequestParameters.OAUTH_SERVICE] = \"google\";\r\n        params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;\r\n\r\n        gadgets.io.makeRequest(url, function (response) {\r\n          if (response.approvalUrl) {\r\n            var personalize = document.getElementById('personalize');\r\n            personalize.href = response.approvalUrl;\r\n            showOneSection('approval');\r\n          } else if (response.data) {\r\n            showOneSection('main');\r\n            showResults(response.data);\r\n          } else {\r\n            var main = document.getElementById('main');\r\n            var wtf = document.createTextNode('Something went wrong');\r\n            main.appendChild(wtf);\r\n            showOneSection('main');\r\n          }\r\n        }, params);\r\n      }\r\n\r\n      gadgets.util.registerOnLoadHandler(fetchData);\r\n    </script>\r\n        ]]>\r\n  </Content>\r\n</Module>"]],"start1":0,"start2":0,"length1":0,"length2":3858}]],"length":3858,"saved":false}
